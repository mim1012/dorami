# Minimal Nginx profile for pre-switch blue/green canary.
# Shared in docker-compose.prod-blue-green.yml with profile "canary".
server {
  listen 80;
  server_name _;

  client_max_body_size 50M;

  access_log /var/log/nginx/access.log combined;
  error_log /var/log/nginx/error.log warn;

  # Use generated blue/green routing definitions.
  include /etc/nginx/conf.d/streaming-routing.conf;

  location /nginx_status {
    stub_status;
    access_log off;
    allow all;
  }

  # Keep canary health simple.
  location /health {
    access_log off;
    return 200 'ok';
    add_header Content-Type text/plain;
  }
}
