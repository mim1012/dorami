# Fashion Platform â†’ Dorami ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰ ê³„íš

## ğŸ“Š ì „ì²´ ë§ˆì´ê·¸ë ˆì´ì…˜ ë¡œë“œë§µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                 â”‚
â”‚  Fashion Platform (Vite + React Router + Mock Data)            â”‚
â”‚  â†“ (79 ì»´í¬ë„ŒíŠ¸, 714KB)                                         â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Phase 1: ë¼ìš°íŒ… + êµ¬ì¡° ë³€í™˜ (2-4ì‹œê°„)                     â”‚ â”‚
â”‚  â”œâ”€ React Router â†’ Next.js App Router                        â”‚ â”‚
â”‚  â”œâ”€ AdminLayout, Header, Sidebar í†µí•©                        â”‚ â”‚
â”‚  â”œâ”€ ë¯¸ë“¤ì›¨ì–´ ì¸ì¦ ì¶”ê°€                                       â”‚ â”‚
â”‚  â””â”€ /admin, /, /profile ë¼ìš°íŠ¸ í™•ì •                          â”‚ â”‚
â”‚                                                               â”‚ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Phase 2: ì»´í¬ë„ŒíŠ¸ í¬íŒ… (3-5ì‹œê°„)                          â”‚ â”‚
â”‚  â”œâ”€ MainPage (Header + 4ì„¹ì…˜)                                â”‚ â”‚
â”‚  â”œâ”€ AdminLayout (Sidebar + Pages)                            â”‚ â”‚
â”‚  â”œâ”€ 79ê°œ UI ì»´í¬ë„ŒíŠ¸ ë³µì‚¬                                    â”‚ â”‚
â”‚  â””â”€ ìƒ‰ìƒ í…Œë§ˆ ë³€í™˜ (#FF4D8D â†’ #FF1493)                      â”‚ â”‚
â”‚                                                               â”‚ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Phase 3: API ì—°ë™ (2-3ì‹œê°„)                               â”‚ â”‚
â”‚  â”œâ”€ getMainPageData êµ¬í˜„                                     â”‚ â”‚
â”‚  â”œâ”€ useMainPageData hook í†µí•©                                â”‚ â”‚
â”‚  â”œâ”€ í•„ë“œ ë§¤í•‘ (discount â†’ discountRate)                      â”‚ â”‚
â”‚  â””â”€ ì‘ë‹µ unwrap ë¡œì§                                         â”‚ â”‚
â”‚                                                               â”‚ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Phase 4: ì‹¤ì‹œê°„ ê¸°ëŠ¥ (1-2ì‹œê°„)                            â”‚ â”‚
â”‚  â”œâ”€ Socket.IO í´ë¼ì´ì–¸íŠ¸ ì„¤ì •                                â”‚ â”‚
â”‚  â”œâ”€ stream:started/ended ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ                       â”‚ â”‚
â”‚  â””â”€ TanStack Query invalidation                              â”‚ â”‚
â”‚                                                               â”‚ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Phase 5: ì¸ì¦ + ë³´ì•ˆ (1-2ì‹œê°„)                            â”‚ â”‚
â”‚  â”œâ”€ middleware ë¯¸ë“¤ì›¨ì–´ ë³´í˜¸ (/admin)                        â”‚ â”‚
â”‚  â”œâ”€ useAuth() hook í†µí•©                                      â”‚ â”‚
â”‚  â””â”€ Admin role ê²€ì¦                                          â”‚ â”‚
â”‚                                                               â”‚ â”‚
â”‚  â””â”€â†’ âœ… Dorami ê¸°ìˆ ìŠ¤íƒ + Fashion ë””ìì¸                      â”‚ â”‚
â”‚                                                               â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â±ï¸ ì´ ì˜ˆìƒ ì‹œê°„: 10-16ì‹œê°„ (1-2ì¼)
```

---

## ğŸ“ Phase 1: ë¼ìš°íŒ… + êµ¬ì¡° ë³€í™˜ (2-4ì‹œê°„)

### 1.1 ë¼ìš°íŠ¸ êµ¬ì¡° ì¬ì„¤ê³„

**Fashion Platform (í˜„ì¬):**

```
/ (MainPage)
/admin (AdminLayout)
  â”œâ”€ /admin (OverviewPage)
  â”œâ”€ /admin/products
  â”œâ”€ /admin/products/:id
  â”œâ”€ /admin/orders
  â”œâ”€ /admin/customers
  â”œâ”€ /admin/analytics
  â”œâ”€ /admin/settings
  â”œâ”€ /admin/live-management
  â””â”€ /admin/payment-settings
```

**Dorami ê¸°ë°˜ ë³€í™˜:**

```
client-app/src/app/
â”œâ”€ page.tsx                    â† MainPage (Fashion ë””ìì¸)
â”œâ”€ login/page.tsx              â† ê¸°ì¡´ (Kakao OAuth)
â”œâ”€ admin/
â”‚  â”œâ”€ layout.tsx               â† AdminLayout (Fashion ë””ìì¸)
â”‚  â”œâ”€ page.tsx                 â† OverviewPage
â”‚  â”œâ”€ products/page.tsx
â”‚  â”œâ”€ products/[id]/page.tsx
â”‚  â”œâ”€ orders/page.tsx
â”‚  â”œâ”€ customers/page.tsx
â”‚  â”œâ”€ analytics/page.tsx
â”‚  â”œâ”€ settings/page.tsx
â”‚  â”œâ”€ live-management/page.tsx
â”‚  â””â”€ payment-settings/page.tsx
â”œâ”€ profile/register/page.tsx    â† ê¸°ì¡´ (í”„ë¡œí•„ ì™„ì„±)
â””â”€ middleware.ts               â† ì¸ì¦ ë³´í˜¸
```

### 1.2 ì¤‘ìš”: ë¯¸ë“¤ì›¨ì–´ ì„¤ì •

```typescript
// middleware.ts
const PROTECTED_PATHS = ['/admin', '/orders', '/checkout', '/products/:id'];

export function middleware(request: NextRequest) {
  const { pathname } = request.nextUrl;

  const isProtected = PROTECTED_PATHS.some((path) => pathname.startsWith(path));

  if (!isProtected) return NextResponse.next();

  // /adminì€ accessToken + ADMIN role í•„ìˆ˜
  const accessToken = request.cookies.get('accessToken')?.value;
  if (!accessToken) {
    return redirectToLogin(request, pathname);
  }

  return NextResponse.next();
}
```

---

## ğŸ“¦ Phase 2: ì»´í¬ë„ŒíŠ¸ í¬íŒ… (3-5ì‹œê°„)

### 2.1 í•µì‹¬ ì»´í¬ë„ŒíŠ¸ ë§¤í•‘

| Fashion ì»´í¬ë„ŒíŠ¸   | ëŒ€ìƒ ìœ„ì¹˜                                     | ë³€í™˜ ì‘ì—…             |
| ------------------ | --------------------------------------------- | --------------------- |
| MainPage           | `/app/page.tsx`                               | ë°ì´í„° ì—°ë™           |
| Header             | `/components/layout/Header.tsx`               | ë¡œê³ , í…Œë§ˆ í† ê¸€ ìœ ì§€  |
| LiveBanner         | `/components/mainpage/LiveHeroBanner.tsx`     | API ë°ì´í„° ì—°ë™       |
| PopularProducts    | `/components/mainpage/PopularProductGrid.tsx` | í•„ë“œ ë¦¬ë§¤í•‘           |
| LiveExclusiveDeals | `/components/mainpage/LiveExclusiveDeals.tsx` | API ë°ì´í„° ì—°ë™       |
| UpcomingLives      | `/components/mainpage/UpcomingLiveSlider.tsx` | API ë°ì´í„° ì—°ë™       |
| AdminLayout        | `/app/admin/layout.tsx`                       | Sidebar + Header í†µí•© |
| ProductsPage       | `/app/admin/products/page.tsx`                | ê¸°ì¡´ Logic ìœ ì§€       |

### 2.2 ìƒ‰ìƒ í…Œë§ˆ ë³€í™˜

```typescript
// tailwind.config.ts (Dorami)
// Fashion Pink: #FF4D8D
// Dorami Hot Pink: #FF1493

// ëª¨ë“  Fashion ì»´í¬ë„ŒíŠ¸ì—ì„œ:
// text-[#FF4D8D] â†’ text-hot-pink
// bg-[#FF4D8D] â†’ bg-hot-pink
// border-[#FF4D8D] â†’ border-hot-pink
```

---

## ğŸ”— Phase 3: API ì—°ë™ (2-3ì‹œê°„)

### 3.1 í•µì‹¬ API í•¨ìˆ˜

```typescript
// lib/api/mainpage.ts
export async function getMainPageData(): Promise<MainPageData> {
  const [activeRes, upcomingRes, popularRes, liveDealsRes] = await Promise.all([
    apiClient.get('/streaming/active'),
    apiClient.get('/streaming/upcoming', { params: { limit: 4 } }),
    apiClient.get('/products/popular', { params: { limit: 8 } }),
    apiClient.get('/products/live-deals').catch(() => ({ data: null })),
  ]);

  // ì‘ë‹µ unwrap ë° íƒ€ì… ë³€í™˜
  const activeStreams = activeRes.data ?? [];
  const liveDealsData = liveDealsRes.data;

  return {
    currentLive: activeStreams[0] ?? null,
    liveDeals: (liveDealsData?.products ?? []).map((p) => ({
      id: p.id,
      name: p.name,
      price: p.price,
      originalPrice: p.originalPrice,
      discountRate: p.discountRate, // âœ… discount â†’ discountRate
      imageUrl: p.imageUrl, // âœ… image â†’ imageUrl
      status: p.status,
      stock: p.stock,
    })),
    upcomingLives: (upcomingRes.data ?? []).map((s) => ({
      id: s.id,
      streamKey: s.streamKey,
      title: s.title,
      scheduledAt: s.scheduledAt,
      thumbnailUrl: s.thumbnailUrl,
      host: s.host,
    })),
    popularProducts: (popularRes.data?.data ?? []).map((p) => ({
      id: p.id,
      name: p.name,
      price: p.price,
      originalPrice: p.originalPrice,
      discountRate: p.discountRate, // âœ… discount â†’ discountRate
      imageUrl: p.imageUrl, // âœ… image â†’ imageUrl
      isNew: p.isNew,
      soldCount: p.soldCount,
    })),
  };
}
```

### 3.2 í•„ë“œ ë§¤í•‘ ìŠ¤í¬ë¦½íŠ¸

```typescript
// í•„ë“œ ë³€í™˜ ë§¤í¼
const fieldMapper = {
  discount: 'discountRate',
  image: 'imageUrl',
  endTime: null, // âŒ ì—†ìŒ (ì œê±°)
};

// ì‚¬ìš© ì˜ˆ
const transformedProduct = {
  ...product,
  discountRate: product.discount,
  imageUrl: product.image,
  // endTime ì œê±°
};
```

---

## âš¡ Phase 4: ì‹¤ì‹œê°„ ê¸°ëŠ¥ (1-2ì‹œê°„)

### 4.1 WebSocket í†µí•©

```typescript
// lib/hooks/queries/use-mainpage.ts
export function useMainPageData() {
  const queryClient = useQueryClient();

  useEffect(() => {
    const wsUrl = process.env.NEXT_PUBLIC_WS_URL ?? '';
    if (!wsUrl) return;

    let ws: any;
    try {
      ws = io(wsUrl, {
        withCredentials: true,
        reconnectionAttempts: 3,
      });
    } catch (error) {
      console.error('WebSocket ì—°ê²° ì˜¤ë¥˜:', error);
      return;
    }

    // ì„¸ ê°€ì§€ ì£¼ìš” ì´ë²¤íŠ¸
    ws.on('stream:started', () => {
      queryClient.invalidateQueries({ queryKey: mainpageKeys.data() });
    });

    ws.on('stream:ended', () => {
      queryClient.invalidateQueries({ queryKey: mainpageKeys.data() });
    });

    ws.on('upcoming:updated', () => {
      queryClient.invalidateQueries({ queryKey: mainpageKeys.data() });
    });

    return () => ws.disconnect();
  }, [queryClient]);

  // TanStack Query
  return useQuery({
    queryKey: mainpageKeys.data(),
    queryFn: getMainPageData,
    staleTime: 10_000,
    refetchInterval: 30_000,
  });
}
```

---

## ğŸ” Phase 5: ì¸ì¦ + ë³´ì•ˆ (1-2ì‹œê°„)

### 5.1 Admin ë¼ìš°íŠ¸ ë³´í˜¸

```typescript
// app/admin/layout.tsx
'use client';

import { useAuth } from '@/lib/hooks/use-auth';
import { Navigate } from 'next/navigation';

export default function AdminLayout({ children }) {
  const { isAuthenticated, user, isLoading } = useAuth();

  if (isLoading) return <LoadingSpinner />;

  // 1ï¸âƒ£ ì¸ì¦ í•„ìˆ˜
  if (!isAuthenticated) {
    return <Navigate to="/login" />;
  }

  // 2ï¸âƒ£ Admin role í•„ìˆ˜
  if (user?.role !== 'ADMIN') {
    return <Navigate to="/" />;
  }

  return <AdminLayoutUI>{children}</AdminLayoutUI>;
}
```

### 5.2 JWT ìë™ ê°±ì‹  (ê¸°ì¡´ ì½”ë“œ ê·¸ëŒ€ë¡œ)

```typescript
// lib/api/client.ts (Dorami ê¸°ì¡´)
// - accessToken ì¿ í‚¤ ìë™ í¬í•¨
// - 401 ì‹œ refreshTokenìœ¼ë¡œ ìë™ ê°±ì‹ 
// - ëª¨ë“  API í˜¸ì¶œì—ì„œ íˆ¬ëª…í•˜ê²Œ ë™ì‘
```

---

## âœ… ë§ˆì´ê·¸ë ˆì´ì…˜ ì²´í¬ë¦¬ìŠ¤íŠ¸

```
Phase 1: ë¼ìš°íŒ… ë³€í™˜
- [ ] Next.js ì•± í´ë” êµ¬ì¡° ìƒì„±
- [ ] middleware.ts ì‘ì„±
- [ ] ë¼ìš°íŠ¸ ë§¤í•‘ ì™„ë£Œ

Phase 2: ì»´í¬ë„ŒíŠ¸ í¬íŒ…
- [ ] MainPage ì»´í¬ë„ŒíŠ¸ ë³µì‚¬
- [ ] AdminLayout í†µí•©
- [ ] 79ê°œ UI ì»´í¬ë„ŒíŠ¸ ì´ë™
- [ ] ìƒ‰ìƒ í…Œë§ˆ ë³€í™˜ ì™„ë£Œ

Phase 3: API ì—°ë™
- [ ] getMainPageData êµ¬í˜„
- [ ] í•„ë“œ ë§¤í•‘ í™•ì¸
- [ ] ì‘ë‹µ íƒ€ì… ì •ì˜
- [ ] API í˜¸ì¶œ í…ŒìŠ¤íŠ¸

Phase 4: WebSocket
- [ ] Socket.IO í´ë¼ì´ì–¸íŠ¸ ì„¤ì •
- [ ] ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
- [ ] TanStack Query invalidation í…ŒìŠ¤íŠ¸

Phase 5: ì¸ì¦
- [ ] Admin ë¼ìš°íŠ¸ ë¯¸ë“¤ì›¨ì–´ ë³´í˜¸
- [ ] useAuth() í†µí•©
- [ ] Admin role ê²€ì¦ í…ŒìŠ¤íŠ¸

Phase 6: ìµœì¢… í…ŒìŠ¤íŠ¸
- [ ] MainPage: ë°ì´í„° ë¡œë“œ í™•ì¸
- [ ] Admin: ë¡œê·¸ì¸ â†’ ì§„ì… (ì¸ì¦ í™•ì¸)
- [ ] WebSocket: ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸
- [ ] ì‘ë‹µì„± + ì„±ëŠ¥ í…ŒìŠ¤íŠ¸
```

---

## ğŸ“ˆ ê¸°ëŒ€ íš¨ê³¼

| í•­ëª©     | Before              | After                              |
| -------- | ------------------- | ---------------------------------- |
| ê¸°ìˆ ìŠ¤íƒ | Vite + React Router | Next.js + TanStack Query           |
| ë””ìì¸   | Dorami ë‹¤í¬í…Œë§ˆ     | **Fashion Platform ë¼ì´íŠ¸í…Œë§ˆ** âœ¨ |
| ë°ì´í„°   | Mock ë°°ì—´           | **Dorami API** âœ…                  |
| ì¸ì¦     | ì—†ìŒ                | **Kakao OAuth + JWT** ğŸ”           |
| ì‹¤ì‹œê°„   | ì—†ìŒ                | **WebSocket ì—…ë°ì´íŠ¸** âš¡          |
| Admin    | ë³´í˜¸ ì—†ìŒ           | **ë¯¸ë“¤ì›¨ì–´ ë³´í˜¸** ğŸ”’               |

---

## âš ï¸ í•µì‹¬ ì£¼ì˜ì‚¬í•­

1. **API ì‘ë‹µ êµ¬ì¡°**: `{ data: { data: [...], meta: {...} } }` í˜•ì‹ ì² ì €íˆ í™•ì¸
2. **í•„ë“œ ì´ë¦„**: `discount` â†’ `discountRate`, `image` â†’ `imageUrl` ëª¨ë‘ ë¦¬ë§¤í•‘
3. **JWT ì¿ í‚¤**: apiClientê°€ ìë™ìœ¼ë¡œ ì²˜ë¦¬ (ì¶”ê°€ ì‘ì—… ë¶ˆí•„ìš”)
4. **Admin ë³´í˜¸**: middleware + ì»´í¬ë„ŒíŠ¸ ë ˆë²¨ ì´ì¤‘ ê²€ì¦
5. **ìƒ‰ìƒ**: ëª¨ë“  Fashionì˜ `#FF4D8D` â†’ Doramiì˜ `#FF1493` ë³€í™˜

---

**ë‹¤ìŒ ë‹¨ê³„: UI ëª©ì—… í™•ì¸ í›„ Phase 1 ì°©ìˆ˜** ğŸš€
